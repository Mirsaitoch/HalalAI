#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–æ—Ä—Ç–∞

PORT=${1:-8000}

echo "üîç –ü–æ–∏—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞ –ø–æ—Ä—Ç—É $PORT..."

# –ù–∞—Ö–æ–¥–∏–º PID –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞ –ø–æ—Ä—Ç—É
PID=$(lsof -ti:$PORT)

if [ -z "$PID" ]; then
    echo "‚úÖ –ü–æ—Ä—Ç $PORT —Å–≤–æ–±–æ–¥–µ–Ω"
    exit 0
fi

echo "‚ö†Ô∏è  –ù–∞–π–¥–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å PID: $PID"
echo "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ:"
lsof -i:$PORT

# –°–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
read -p "–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å? (y/n) " -n 1 -r
echo

if [[ $REPLY =~ ^[Yy]$ ]]; then
    kill -9 $PID
    echo "‚úÖ –ü—Ä–æ—Ü–µ—Å—Å $PID –∑–∞–≤–µ—Ä—à–µ–Ω, –ø–æ—Ä—Ç $PORT —Å–≤–æ–±–æ–¥–µ–Ω"
else
    echo "‚ùå –û—Ç–º–µ–Ω–µ–Ω–æ"
    exit 1
fi
